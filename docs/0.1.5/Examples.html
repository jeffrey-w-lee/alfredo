<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">











<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>Alfredo - Alfredo, Java HTTP SPNEGO 0.1.5 - Examples</title>
    <style type="text/css" media="all">
      @import url("./css/maven-base.css");
      @import url("./css/maven-theme.css");
      @import url("./css/site.css");
    </style>
    <link rel="stylesheet" href="./css/print.css" type="text/css" media="print" />
          <meta name="author" content="Alejandro Abdelnur" />
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
      </head>
  <body class="composite">
    <div id="banner">
                    <span id="bannerLeft">
    
            Â 
    
            </span>
                    <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
          
  

  
    
            
  
    
            <div class="xleft">
        Last Published: 2012-02-13
                      </div>
            <div class="xright">            <a href="../index.html">OTHER RELEASES</a>
            |
                <a href="http://www.cloudera.com/" class="externalLink">Cloudera</a>
            
  

  
    
            
  
    
             Version: 0.1.5
      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
           
  

  
    
            
  
    
                                                <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
            <img alt="Built by Maven" src="./images/logos/maven-feather.png"></img>
          </a>
                       
  

  
    
            
  
    
        </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
        <div class="section"><h2>Alfredo, Java HTTP SPNEGO 0.1.5 - Examples</h2>
<p>[ <a href="index.html">Go Back</a> ]</p>
<div class="section"><h3>Accessing a Alfredo protected URL Using a browser</h3>
<p><b>IMPORTANT:</b> The browser must support HTTP Kerberos SPNEGO. For example, Firefox or Internet Explorer.</p>
<p>For Firefox access the low level configuration page by loading the <tt>about:config</tt> page. Then go to the <tt>network.negotiate-auth.trusted-uris</tt> preference and add the hostname or the domain of the web server that is HTTP Kerberos SPNEGO protected (if using multiple domains and hostname use comma to separate them).</p>
</div>
<div class="section"><h3>Accessing a Alfredo protected URL Using <tt>curl</tt></h3>
<p><b>IMPORTANT:</b> The <tt>curl</tt> version must support GSS, run <tt>curl -V</tt>.</p>
<div class="source"><pre>$ curl -V
curl 7.19.7 (universal-apple-darwin10.0) libcurl/7.19.7 OpenSSL/0.9.8l zlib/1.2.3
Protocols: tftp ftp telnet dict ldap http file https ftps
Features: GSS-Negotiate IPv6 Largefile NTLM SSL libz</pre>
</div>
<p>Login to the KDC using <b>kinit</b> and then use <tt>curl</tt> to fetch protected URL:</p>
<div class="source"><pre>$ kinit
Please enter the password for tucu@LOCALHOST:
$ curl --negotiate -u foo -b ~/cookiejar.txt -c ~/cookiejar.txt http://localhost:8080/alfredo-examples/kerberos/who
Enter host password for user 'tucu':

Hello Alfredo!</pre>
</div>
<ul><li>The <tt>--negotiate</tt> option enables SPNEGO in <tt>curl</tt>.</li>
<li>The <tt>-u foo</tt> option is required but the user ignored (the principal that has been kinit-ed is used).</li>
<li>The <tt>-b</tt> and <tt>-c</tt> are use to store and send HTTP Cookies.</li>
</ul>
</div>
<div class="section"><h3>Using the Java Client</h3>
<p>Use the <tt>AuthenticatedURL</tt> class to obtain an authenticated HTTP connection:</p>
<div class="source"><pre>...
URL url = new URL(&quot;http://localhost:8080/alfredo/kerberos/who&quot;);
AuthenticatedURL.Token token = new AuthenticatedURL.Token();
...
HttpURLConnection conn = new AuthenticatedURL(url, token).openConnection();
...
conn = new AuthenticatedURL(url, token).openConnection();
...</pre>
</div>
</div>
<div class="section"><h3>Building and Running the Examples</h3>
<p>Download Alfredo's source code, the examples are in a Maven project in the <tt>examples</tt> directory.</p>
<div class="section"><h4>Server Example:</h4>
<p>Edit the <tt>examples/src/main/webapp/WEB-INF/web.xml</tt> and set the right configuration init parameters for the <tt>AuthenticationFilter</tt> definition configured for Kerberos (the right Kerberos principal and keytab file must be specified). Refer to the <a href="Configuration.html">Configuration document</a> for details.</p>
<p>Create the web application WAR file by running the <tt>mvn package</tt> command.</p>
<p>Deploy the WAR file in a servlet container. For example, if using Tomcat, copy the WAR file to Tomcat's <tt>webapps/</tt> directory.</p>
<p>Start the servlet container.</p>
</div>
<div class="section"><h4>Accessing the server using&gt;&gt; <tt>curl</tt></h4>
<p>Try accessing protected resources using <tt>curl</tt>. The protected resources are:</p>
<div class="source"><pre>$ kinit
Please enter the password for tucu@LOCALHOST:

$ curl http://localhost:8080/alfredo-examples/anonymous/who

$ curl http://localhost:8080/alfredo-examples/simple/who?user.name=foo

$ curl --negotiate -u foo -b ~/cookiejar.txt -c ~/cookiejar.txt http://localhost:8080/alfredo-examples/kerberos/who</pre>
</div>
</div>
<div class="section"><h4>Accessing the server using the Java client example&gt;&gt;</h4>
<div class="source"><pre>$ kinit
Please enter the password for tucu@LOCALHOST:

$ cd examples

$ mvn exec:java -Durl=http://localhost:8080/alfredo-examples/kerberos/who

....

Token value: &quot;u=tucu,p=tucu@LOCALHOST,t=kerberos,e=1295305313146,s=sVZ1mpSnC5TKhZQE3QLN5p2DWBo=&quot;
Status code: 200 OK

You are: user[tucu] principal[tucu@LOCALHOST]

....
</pre>
</div>
<p>[ <a href="index.html">Go Back</a> ]</p>
</div>
</div>
</div>

      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">&#169;  
          2012
    
          Cloudera Inc.
          
  

  
    
            
  
    
   - <a href="http://maven.apache.org/privacy-policy.html">Privacy Policy</a></div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
